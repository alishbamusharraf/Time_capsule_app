def home():
    login_required()

    def is_unlocked(c):
        return datetime.strptime(c['unlock_date'], "%Y-%m-%d %H:%M") <= datetime.now()

    for c in capsules:
        c['is_unlocked'] = is_unlocked(c)

    st.title("ğŸ“¦ Your Time Capsules")
    st.write("### Here are your created capsules:")

    if not capsules:
        st.info("No capsules yet. Create one from the 'Create' page.")
    else:
        for idx, capsule in enumerate(capsules):
            with st.container():
                st.markdown(f"#### ğŸ“Œ {capsule['title']}")
                st.write(f"**Message:** {capsule['message']}")
                st.write(f"**Unlock Date:** {capsule['unlock_date']}")
                st.write(f"**Unlocked:** {'âœ… Yes' if capsule['is_unlocked'] else 'â³ No'}")
                
                if capsule['media_filename']:
                    media_path = os.path.join(UPLOAD_FOLDER, capsule['media_filename'])
                    if media_path.endswith(('jpg', 'png', 'jpeg', 'gif')):
                        st.image(media_path, width=300)
                    elif media_path.endswith(('mp4',)):
                        st.video(media_path)

                delete_button = st.button(f"ğŸ—‘ï¸ Delete Capsule {idx + 1}", key=f"delete{idx}")
                if delete_button:
                    capsules.pop(idx)
                    st.success("Capsule deleted successfully.")
                    st.rerun()

                st.markdown("---")
